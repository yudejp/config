server {
  listen [::]:80;
  server_name nc.yude.jp;
  add_header Strict-Transport-Security "max-age=15768000; includeSubDomains; preload;" always;
  location / {
    proxy_pass http://100.117.175.86:8089;
    proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header    X-Real-IP $remote_addr;
    proxy_set_header    Host $http_host;
  }
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }
   location ^~ /.well-known {
        # The rules in this block are an adaptation of the rules
        # in `.htaccess` that concern `/.well-known`.

        location = /.well-known/carddav { return 301 https://nc.yude.jp/remote.php/dav/; }
        location = /.well-known/caldav  { return 301 https://nc.yude.jp/remote.php/dav/; }
        location = /.well-known/webfinger {
      return 301 https://nc.yude.jp/$uri;
    }
    location = /.well-known/nodeinfo {return 301 https://nc.yude.jp/index.php/$uri;
    }
        location /.well-known/acme-challenge    { try_files $uri $uri/ =404; }
        location /.well-known/pki-validation    { try_files $uri $uri/ =404; }

        # Let Nextcloud's API for `/.well-known` URIs handle all other
        # requests by passing them to the front-end controller.
        return 301 /index.php$request_uri;
    }

}