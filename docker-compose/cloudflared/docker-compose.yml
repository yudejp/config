version: '3'

services:
    cloudflared-roundcube:
        image: cloudflare/cloudflared:2021.8.3
        user: root
        command: tunnel
        environment:
            - TUNNEL_HOSTNAME=roundcube.yude.jp
            - TUNNEL_URL=http://host.docker.internal:9002
            - TUNNEL_ORIGIN_CERT=/root/.cloudflared/cert.pem
        volumes:
            - '$HOME/.cloudflared:/root/.cloudflared'
        extra_hosts:
            - "host.docker.internal:host-gateway"
        restart: always

    cloudflared-bluemap:
        image: cloudflare/cloudflared:2021.8.3
        user: root
        command: tunnel
        environment:
            - TUNNEL_HOSTNAME=bluemap.yude.jp
            - TUNNEL_URL=http://host.docker.internal:8100
            - TUNNEL_ORIGIN_CERT=/root/.cloudflared/cert.pem
        volumes:
            - '$HOME/.cloudflared:/root/.cloudflared'
        extra_hosts:
            - "host.docker.internal:host-gateway"
        restart: always

    
    cloudflared-nextcloud:
        image: cloudflare/cloudflared:2021.8.3
        user: root
        command: tunnel
        environment:
            - TUNNEL_HOSTNAME=nc.yude.jp
            - TUNNEL_URL=http://host.docker.internal:9000
            - TUNNEL_ORIGIN_CERT=/root/.cloudflared/cert.pem
        volumes:
            - '$HOME/.cloudflared:/root/.cloudflared'
        extra_hosts:
            - "host.docker.internal:host-gateway"
        restart: always
            
    cloudflared-wikijs:
        image: cloudflare/cloudflared:2021.8.3
        user: root
        command: tunnel
        environment:
            - TUNNEL_HOSTNAME=wiki.yude.jp
            - TUNNEL_URL=http://host.docker.internal:9202
            - TUNNEL_ORIGIN_CERT=/root/.cloudflared/cert.pem
        volumes:
            - '$HOME/.cloudflared:/root/.cloudflared'
        extra_hosts:
            - "host.docker.internal:host-gateway"
        restart: always
